<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="prev" title="What is DiffusionLab?" href="index.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>API Reference - DiffusionLab Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">DiffusionLab Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">DiffusionLab Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">API Reference</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/api.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading">¶</a></h1>
<!-- This page contains the automatically generated API reference documentation. -->
<section id="module-diffusionlab">
<span id="diffusionlab"></span><h2><code class="docutils literal notranslate"><span class="pre">diffusionlab</span></code><a class="headerlink" href="#module-diffusionlab" title="Link to this heading">¶</a></h2>
</section>
<section id="module-diffusionlab.distributions">
<span id="diffusionlab-distributions"></span><h2><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions</span></code><a class="headerlink" href="#module-diffusionlab.distributions" title="Link to this heading">¶</a></h2>
<section id="module-diffusionlab.distributions.base">
<span id="diffusionlab-distributions-base"></span><h3><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.base</span></code><a class="headerlink" href="#module-diffusionlab.distributions.base" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.distributions.base.Distribution">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.distributions.base.</span></span><span class="sig-name descname"><span class="pre">Distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_hparams</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/diffusionlab/distributions/base.html#Distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.base.Distribution" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for all distributions.</p>
<p>This class should be subclassed by other distributions when you want to use ground truth
scores, denoisers, noise predictors, or velocity estimators.</p>
<p>Each distribution implementation provides functions to sample from it and compute various vector fields
related to a diffusion process, such as denoising (<code class="docutils literal notranslate"><span class="pre">x0</span></code>), noise prediction (<code class="docutils literal notranslate"><span class="pre">eps</span></code>),
velocity estimation (<code class="docutils literal notranslate"><span class="pre">v</span></code>), and score estimation (<code class="docutils literal notranslate"><span class="pre">score</span></code>).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.distributions.base.Distribution.dist_params">
<span class="sig-name descname"><span class="pre">dist_params</span></span><a class="headerlink" href="#diffusionlab.distributions.base.Distribution.dist_params" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary containing distribution parameters as JAX arrays.
Shapes depend on the specific distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Array]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.distributions.base.Distribution.dist_hparams">
<span class="sig-name descname"><span class="pre">dist_hparams</span></span><a class="headerlink" href="#diffusionlab.distributions.base.Distribution.dist_hparams" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary containing distribution hyperparameters (non-array values).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.base.Distribution.eps">
<span class="sig-name descname"><span class="pre">eps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/base.html#Distribution.eps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.base.Distribution.eps" title="Link to this definition">¶</a></dt>
<dd><p>Predict the noise component <code class="docutils literal notranslate"><span class="pre">ε</span></code> corresponding to the noisy state <code class="docutils literal notranslate"><span class="pre">x_t</span></code> at time <code class="docutils literal notranslate"><span class="pre">t</span></code>,
given the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step.</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The predicted noise <code class="docutils literal notranslate"><span class="pre">ε</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.base.Distribution.get_vector_field">
<span class="sig-name descname"><span class="pre">get_vector_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector_field_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.vector_fields.VectorFieldType" title="diffusionlab.vector_fields.VectorFieldType"><span class="pre">VectorFieldType</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/base.html#Distribution.get_vector_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.base.Distribution.get_vector_field" title="Link to this definition">¶</a></dt>
<dd><p>Get the vector field function of a given type associated with this distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vector_field_type</strong> (<code class="docutils literal notranslate"><span class="pre">VectorFieldType</span></code>) – The type of vector field to retrieve (e.g., <code class="docutils literal notranslate"><span class="pre">VectorFieldType.SCORE</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.X0</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.EPS</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.V</span></code>).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The requested vector field function. It takes the current state <code class="docutils literal notranslate"><span class="pre">x_t</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>),
time <code class="docutils literal notranslate"><span class="pre">t</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>), and the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code> as input and returns the
corresponding vector field value (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[*data_dims],</span> <span class="pre">Array[],</span> <span class="pre">DiffusionProcess],</span> <span class="pre">Array[*data_dims]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.base.Distribution.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/base.html#Distribution.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.base.Distribution.sample" title="Link to this definition">¶</a></dt>
<dd><p>Sample from the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<code class="docutils literal notranslate"><span class="pre">Array</span></code>) – The JAX PRNG key to use for sampling.</p></li>
<li><p><strong>num_samples</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – The number of samples to draw.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the samples and any additional information.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Tuple[Array[num_samples,</span> <span class="pre">*data_dims],</span> <span class="pre">Any]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.base.Distribution.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/base.html#Distribution.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.base.Distribution.score" title="Link to this definition">¶</a></dt>
<dd><p>Compute the score function (<code class="docutils literal notranslate"><span class="pre">∇_x</span> <span class="pre">log</span> <span class="pre">p_t(x)</span></code>) of the distribution at time <code class="docutils literal notranslate"><span class="pre">t</span></code>,
given the noisy state <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step.</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of the distribution at <code class="docutils literal notranslate"><span class="pre">(x_t,</span> <span class="pre">t)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.base.Distribution.v">
<span class="sig-name descname"><span class="pre">v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/base.html#Distribution.v"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.base.Distribution.v" title="Link to this definition">¶</a></dt>
<dd><p>Compute the velocity field <code class="docutils literal notranslate"><span class="pre">v(x_t,</span> <span class="pre">t)</span></code> corresponding to the noisy state <code class="docutils literal notranslate"><span class="pre">x_t</span></code> at time <code class="docutils literal notranslate"><span class="pre">t</span></code>,
given the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step.</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed velocity field <code class="docutils literal notranslate"><span class="pre">v</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.base.Distribution.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/base.html#Distribution.x0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.base.Distribution.x0" title="Link to this definition">¶</a></dt>
<dd><p>Predict the initial state <code class="docutils literal notranslate"><span class="pre">x0</span></code> (denoised sample) from the noisy state <code class="docutils literal notranslate"><span class="pre">x_t</span></code> at time <code class="docutils literal notranslate"><span class="pre">t</span></code>,
given the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step.</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The predicted initial state <code class="docutils literal notranslate"><span class="pre">x0</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-diffusionlab.distributions.empirical">
<span id="diffusionlab-distributions-empirical"></span><h3><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.empirical</span></code><a class="headerlink" href="#module-diffusionlab.distributions.empirical" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.distributions.empirical.EmpiricalDistribution">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.distributions.empirical.</span></span><span class="sig-name descname"><span class="pre">EmpiricalDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labeled_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/diffusionlab/distributions/empirical.html#EmpiricalDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.empirical.EmpiricalDistribution" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#diffusionlab.distributions.base.Distribution" title="diffusionlab.distributions.base.Distribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></a></p>
<p>An empirical distribution, i.e., the uniform distribution over a dataset.
The probability measure is defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">μ(A)</span> <span class="pre">=</span> <span class="pre">(1/N)</span> <span class="pre">*</span> <span class="pre">sum_{i=1}^{num_samples}</span> <span class="pre">delta(x_i</span> <span class="pre">in</span> <span class="pre">A)</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">x_i</span></code> is the ith data point in the dataset, and <code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of data points.</p>
<p>This class provides methods for sampling from the empirical distribution and computing various vector fields (<code class="docutils literal notranslate"><span class="pre">VectorFieldType.SCORE</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.X0</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.EPS</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.V</span></code>) related to the distribution under a given diffusion process.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.distributions.empirical.EmpiricalDistribution.dist_params">
<span class="sig-name descname"><span class="pre">dist_params</span></span><a class="headerlink" href="#diffusionlab.distributions.empirical.EmpiricalDistribution.dist_params" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary containing distribution parameters (currently unused).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Array]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.distributions.empirical.EmpiricalDistribution.dist_hparams">
<span class="sig-name descname"><span class="pre">dist_hparams</span></span><a class="headerlink" href="#diffusionlab.distributions.empirical.EmpiricalDistribution.dist_hparams" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary for storing hyperparameters. It may contain the following keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">labeled_data</span></code> (<code class="docutils literal notranslate"><span class="pre">Iterable[Tuple[Array,</span> <span class="pre">Array]]</span> <span class="pre">|</span> <span class="pre">Iterable[Tuple[Array,</span> <span class="pre">None]]</span></code>): An iterable of data whose elements (samples) are tuples of (data batch, label batch). The label batch can be <code class="docutils literal notranslate"><span class="pre">None</span></code> if the data is unlabelled.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.empirical.EmpiricalDistribution.eps">
<span class="sig-name descname"><span class="pre">eps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/empirical.html#EmpiricalDistribution.eps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.empirical.EmpiricalDistribution.eps" title="Link to this definition">¶</a></dt>
<dd><p>Computes the noise field <code class="docutils literal notranslate"><span class="pre">eps(x_t,</span> <span class="pre">t)</span></code> for an empirical distribution w.r.t. a given diffusion process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The input tensor.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time tensor.</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The noise field at <code class="docutils literal notranslate"><span class="pre">(x_t,</span> <span class="pre">t)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.empirical.EmpiricalDistribution.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/empirical.html#EmpiricalDistribution.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.empirical.EmpiricalDistribution.sample" title="Link to this definition">¶</a></dt>
<dd><p>Sample from the empirical distribution using reservoir sampling.
Assumes all batches in <code class="docutils literal notranslate"><span class="pre">labeled_data</span></code> are consistent: either all have labels (<code class="docutils literal notranslate"><span class="pre">Array</span></code>)
or none have labels (<code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<code class="docutils literal notranslate"><span class="pre">Array</span></code>) – The JAX PRNG key to use for sampling.</p></li>
<li><p><strong>num_samples</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – The number of samples to draw.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(samples,</span> <span class="pre">labels)</span></code> containing the samples and corresponding labels (stacked into an <code class="docutils literal notranslate"><span class="pre">Array</span></code>), or <code class="docutils literal notranslate"><span class="pre">(samples,</span> <span class="pre">None)</span></code> if the data is unlabelled.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Tuple[Array[num_samples,</span> <span class="pre">*data_dims],</span> <span class="pre">Array[num_samples,</span> <span class="pre">*label_dims]]</span> <span class="pre">|</span> <span class="pre">Tuple[Array[num_samples,</span> <span class="pre">*data_dims],</span> <span class="pre">None]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.empirical.EmpiricalDistribution.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/empirical.html#EmpiricalDistribution.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.empirical.EmpiricalDistribution.score" title="Link to this definition">¶</a></dt>
<dd><p>Computes the score function (<code class="docutils literal notranslate"><span class="pre">∇_x</span> <span class="pre">log</span> <span class="pre">p_t(x)</span></code>) of the empirical distribution at time <code class="docutils literal notranslate"><span class="pre">t</span></code>,
given the noisy state <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and the diffusion process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time tensor.</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of the empirical distribution at <code class="docutils literal notranslate"><span class="pre">(x_t,</span> <span class="pre">t)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.empirical.EmpiricalDistribution.v">
<span class="sig-name descname"><span class="pre">v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/empirical.html#EmpiricalDistribution.v"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.empirical.EmpiricalDistribution.v" title="Link to this definition">¶</a></dt>
<dd><p>Computes the velocity field <code class="docutils literal notranslate"><span class="pre">v(x_t,</span> <span class="pre">t)</span></code> for an empirical distribution w.r.t. a given diffusion process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The input tensor.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time tensor.</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The velocity field at <code class="docutils literal notranslate"><span class="pre">(x_t,</span> <span class="pre">t)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.empirical.EmpiricalDistribution.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/empirical.html#EmpiricalDistribution.x0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.empirical.EmpiricalDistribution.x0" title="Link to this definition">¶</a></dt>
<dd><p>Computes the denoiser <code class="docutils literal notranslate"><span class="pre">E[x_0</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> for an empirical distribution w.r.t. a given diffusion process.</p>
<p>This method computes the denoiser by performing a weighted average of the
dataset samples, where the weights are determined by the likelihood of <code class="docutils literal notranslate"><span class="pre">x_t</span></code>
given each sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The input tensor.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time tensor.</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The prediction of <code class="docutils literal notranslate"><span class="pre">x_0</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-diffusionlab.distributions.gmm">
<span id="diffusionlab-distributions-gmm"></span><h3><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.gmm</span></code><a class="headerlink" href="#module-diffusionlab.distributions.gmm" title="Link to this heading">¶</a></h3>
<section id="module-diffusionlab.distributions.gmm.gmm">
<span id="diffusionlab-distributions-gmm-gmm"></span><h4><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.gmm.gmm</span></code><a class="headerlink" href="#module-diffusionlab.distributions.gmm.gmm" title="Link to this heading">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.gmm.GMM">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.distributions.gmm.gmm.</span></span><span class="sig-name descname"><span class="pre">GMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">means</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/gmm.html#GMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.gmm.GMM" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#diffusionlab.distributions.base.Distribution" title="diffusionlab.distributions.base.Distribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></a></p>
<p>Implements a Gaussian Mixture Model (GMM) distribution.</p>
<p>The probability measure is given by:</p>
<p><code class="docutils literal notranslate"><span class="pre">μ(A)</span> <span class="pre">=</span> <span class="pre">sum_{i=1}^{num_components}</span> <span class="pre">priors[i]</span> <span class="pre">*</span> <span class="pre">N(A;</span> <span class="pre">means[i],</span> <span class="pre">covs[i])</span></code></p>
<p>This class provides methods for sampling from the GMM and computing various vector fields (<code class="docutils literal notranslate"><span class="pre">VectorFieldType.SCORE</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.X0</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.EPS</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.V</span></code>) related to the distribution under a given diffusion process.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.gmm.GMM.dist_params">
<span class="sig-name descname"><span class="pre">dist_params</span></span><a class="headerlink" href="#diffusionlab.distributions.gmm.gmm.GMM.dist_params" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary containing the core GMM parameters.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">means</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[num_components,</span> <span class="pre">data_dim]</span></code>): The means of the GMM components.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">covs</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[num_components,</span> <span class="pre">data_dim,</span> <span class="pre">data_dim]</span></code>): The covariance matrices of the GMM components.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">priors</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[num_components]</span></code>): The prior probabilities (mixture weights) of the GMM components.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Array]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.gmm.GMM.dist_hparams">
<span class="sig-name descname"><span class="pre">dist_hparams</span></span><a class="headerlink" href="#diffusionlab.distributions.gmm.gmm.GMM.dist_hparams" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary for storing hyperparameters (currently unused).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.gmm.GMM.eps">
<span class="sig-name descname"><span class="pre">eps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/gmm.html#GMM.eps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.gmm.GMM.eps" title="Link to this definition">¶</a></dt>
<dd><p>Computes the noise prediction <code class="docutils literal notranslate"><span class="pre">ε</span></code> for the GMM distribution.</p>
<p>This predicts the noise that was added to the original sample <code class="docutils literal notranslate"><span class="pre">x_0</span></code> to obtain <code class="docutils literal notranslate"><span class="pre">x_t</span></code>
at time <code class="docutils literal notranslate"><span class="pre">t</span></code> under the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The noise prediction vector field <code class="docutils literal notranslate"><span class="pre">ε</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.gmm.GMM.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/gmm.html#GMM.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.gmm.GMM.sample" title="Link to this definition">¶</a></dt>
<dd><p>Draws samples from the GMM distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<code class="docutils literal notranslate"><span class="pre">Array</span></code>) – JAX PRNG key for random sampling.</p></li>
<li><p><strong>num_samples</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – The total number of samples to generate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(samples,</span> <span class="pre">component_indices)</span></code> containing the drawn samples and the index of the GMM component from which each sample was drawn.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Tuple[Array[num_samples,</span> <span class="pre">data_dim],</span> <span class="pre">Array[num_samples]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.gmm.GMM.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/gmm.html#GMM.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.gmm.GMM.score" title="Link to this definition">¶</a></dt>
<dd><p>Computes the score vector field <code class="docutils literal notranslate"><span class="pre">(∇_x</span> <span class="pre">log</span> <span class="pre">p_t(x_t))</span></code> for the GMM distribution.</p>
<p>This is calculated with respect to the perturbed distribution <code class="docutils literal notranslate"><span class="pre">p_t</span></code> induced by the
<code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code> at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score vector field evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.gmm.GMM.v">
<span class="sig-name descname"><span class="pre">v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/gmm.html#GMM.v"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.gmm.GMM.v" title="Link to this definition">¶</a></dt>
<dd><p>Computes the velocity vector field <code class="docutils literal notranslate"><span class="pre">v</span></code> for the GMM distribution.</p>
<p>This relates to the conditional velocity <code class="docutils literal notranslate"><span class="pre">E[dx_t/dt</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> under the
<code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The velocity vector field <code class="docutils literal notranslate"><span class="pre">v</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.gmm.GMM.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/gmm.html#GMM.x0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.gmm.GMM.x0" title="Link to this definition">¶</a></dt>
<dd><p>Computes the denoised prediction <code class="docutils literal notranslate"><span class="pre">x0</span> <span class="pre">=</span> <span class="pre">E[x_0</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> for the GMM distribution.</p>
<p>This represents the expected original sample <code class="docutils literal notranslate"><span class="pre">x_0</span></code> given the noisy observation <code class="docutils literal notranslate"><span class="pre">x_t</span></code>
at time <code class="docutils literal notranslate"><span class="pre">t</span></code> under the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The denoised prediction vector field <code class="docutils literal notranslate"><span class="pre">x0</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.gmm.gmm_x0">
<span class="sig-prename descclassname"><span class="pre">diffusionlab.distributions.gmm.gmm.</span></span><span class="sig-name descname"><span class="pre">gmm_x0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">means</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/gmm.html#gmm_x0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.gmm.gmm_x0" title="Link to this definition">¶</a></dt>
<dd><p>Computes the denoised prediction <code class="docutils literal notranslate"><span class="pre">x0</span> <span class="pre">=</span> <span class="pre">E[x_0</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> for a GMM.</p>
<p>This implements the closed-form solution for the conditional expectation
<code class="docutils literal notranslate"><span class="pre">E[x_0</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> where <code class="docutils literal notranslate"><span class="pre">x_t</span> <span class="pre">~</span> <span class="pre">N(α_t</span> <span class="pre">x_0,</span> <span class="pre">σ_t^2</span> <span class="pre">I)</span></code> and <code class="docutils literal notranslate"><span class="pre">x_0</span></code> follows the GMM distribution
defined by <code class="docutils literal notranslate"><span class="pre">means</span></code>, <code class="docutils literal notranslate"><span class="pre">covs</span></code>, and <code class="docutils literal notranslate"><span class="pre">priors</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – Provides <code class="docutils literal notranslate"><span class="pre">α(t)</span></code> and <code class="docutils literal notranslate"><span class="pre">σ(t)</span></code>.</p></li>
<li><p><strong>means</strong> (<code class="docutils literal notranslate"><span class="pre">Array[num_components,</span> <span class="pre">data_dim]</span></code>) – Means of the GMM components.</p></li>
<li><p><strong>covs</strong> (<code class="docutils literal notranslate"><span class="pre">Array[num_components,</span> <span class="pre">data_dim,</span> <span class="pre">data_dim]</span></code>) – Covariances of the GMM components.</p></li>
<li><p><strong>priors</strong> (<code class="docutils literal notranslate"><span class="pre">Array[num_components]</span></code>) – Mixture weights of the GMM components.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The denoised prediction <code class="docutils literal notranslate"><span class="pre">x0</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-diffusionlab.distributions.gmm.iso_gmm">
<span id="diffusionlab-distributions-gmm-iso-gmm"></span><h4><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.gmm.iso_gmm</span></code><a class="headerlink" href="#module-diffusionlab.distributions.gmm.iso_gmm" title="Link to this heading">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_gmm.IsoGMM">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.distributions.gmm.iso_gmm.</span></span><span class="sig-name descname"><span class="pre">IsoGMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">means</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/iso_gmm.html#IsoGMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#diffusionlab.distributions.base.Distribution" title="diffusionlab.distributions.base.Distribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></a></p>
<p>Implements an isotropic Gaussian Mixture Model (GMM) distribution.</p>
<p>The probability measure is given by:</p>
<p><code class="docutils literal notranslate"><span class="pre">μ(A)</span> <span class="pre">=</span> <span class="pre">sum_{i=1}^{num_components}</span> <span class="pre">priors[i]</span> <span class="pre">*</span> <span class="pre">N(A;</span> <span class="pre">means[i],</span> <span class="pre">variances[i]</span> <span class="pre">*</span> <span class="pre">I)</span></code></p>
<p>This class provides methods for sampling from the GMM and computing various vector fields (<code class="docutils literal notranslate"><span class="pre">VectorFieldType.SCORE</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.X0</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.EPS</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.V</span></code>) related to the distribution under a given diffusion process.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_gmm.IsoGMM.dist_params">
<span class="sig-name descname"><span class="pre">dist_params</span></span><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM.dist_params" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary containing the core GMM parameters.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">means</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[num_components,</span> <span class="pre">data_dim]</span></code>):  The means of the GMM components.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">variances</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[num_components]</span></code>): The variances of the GMM components.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">priors</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[num_components]</span></code>): The prior probabilities (mixture weights) of the GMM components.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Array]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_gmm.IsoGMM.dist_hparams">
<span class="sig-name descname"><span class="pre">dist_hparams</span></span><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM.dist_hparams" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary for storing hyperparameters (currently unused).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_gmm.IsoGMM.eps">
<span class="sig-name descname"><span class="pre">eps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/iso_gmm.html#IsoGMM.eps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM.eps" title="Link to this definition">¶</a></dt>
<dd><p>Computes the noise prediction <code class="docutils literal notranslate"><span class="pre">ε</span></code> for the isotropic GMM distribution.</p>
<p>This predicts the noise that was added to the original sample <code class="docutils literal notranslate"><span class="pre">x_0</span></code> to obtain <code class="docutils literal notranslate"><span class="pre">x_t</span></code>
at time <code class="docutils literal notranslate"><span class="pre">t</span></code> under the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The noise prediction vector field <code class="docutils literal notranslate"><span class="pre">ε</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_gmm.IsoGMM.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/iso_gmm.html#IsoGMM.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM.sample" title="Link to this definition">¶</a></dt>
<dd><p>Draws samples from the isotropic GMM distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<code class="docutils literal notranslate"><span class="pre">Array</span></code>) – JAX PRNG key for random sampling.</p></li>
<li><p><strong>num_samples</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – The total number of samples to generate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(samples,</span> <span class="pre">component_indices)</span></code> containing the drawn samples and the index of the GMM component from which each sample was drawn.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Tuple[Array[num_samples,</span> <span class="pre">data_dim],</span> <span class="pre">Array[num_samples]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_gmm.IsoGMM.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/iso_gmm.html#IsoGMM.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM.score" title="Link to this definition">¶</a></dt>
<dd><p>Computes the score vector field <code class="docutils literal notranslate"><span class="pre">∇_x</span> <span class="pre">log</span> <span class="pre">p_t(x_t)</span></code> for the isotropic GMM distribution.</p>
<p>This is calculated with respect to the perturbed distribution <code class="docutils literal notranslate"><span class="pre">p_t</span></code> induced by the
<code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code> at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score vector field evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_gmm.IsoGMM.v">
<span class="sig-name descname"><span class="pre">v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/iso_gmm.html#IsoGMM.v"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM.v" title="Link to this definition">¶</a></dt>
<dd><p>Computes the velocity vector field <code class="docutils literal notranslate"><span class="pre">v</span></code> for the isotropic GMM distribution.</p>
<p>This is conditional velocity <code class="docutils literal notranslate"><span class="pre">E[dx_t/dt</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> under the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The velocity vector field <code class="docutils literal notranslate"><span class="pre">v</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_gmm.IsoGMM.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/iso_gmm.html#IsoGMM.x0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM.x0" title="Link to this definition">¶</a></dt>
<dd><p>Computes the denoised prediction <code class="docutils literal notranslate"><span class="pre">x0</span> <span class="pre">=</span> <span class="pre">E[x_0</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> for the isotropic GMM distribution.</p>
<p>This represents the expected original sample <code class="docutils literal notranslate"><span class="pre">x_0</span></code> given the noisy observation <code class="docutils literal notranslate"><span class="pre">x_t</span></code>
at time <code class="docutils literal notranslate"><span class="pre">t</span></code> under the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The denoised prediction vector field <code class="docutils literal notranslate"><span class="pre">x0</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_gmm.iso_gmm_x0">
<span class="sig-prename descclassname"><span class="pre">diffusionlab.distributions.gmm.iso_gmm.</span></span><span class="sig-name descname"><span class="pre">iso_gmm_x0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">means</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/iso_gmm.html#iso_gmm_x0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_gmm.iso_gmm_x0" title="Link to this definition">¶</a></dt>
<dd><p>Computes the denoised prediction <code class="docutils literal notranslate"><span class="pre">x0</span> <span class="pre">=</span> <span class="pre">E[x_0</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> for a GMM.</p>
<p>This implements the closed-form solution for the conditional expectation
<code class="docutils literal notranslate"><span class="pre">E[x_0</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> where <code class="docutils literal notranslate"><span class="pre">x_t</span> <span class="pre">~</span> <span class="pre">N(α_t</span> <span class="pre">x_0,</span> <span class="pre">σ_t^2</span> <span class="pre">I)</span></code> and <code class="docutils literal notranslate"><span class="pre">x_0</span></code> follows the GMM distribution
defined by <code class="docutils literal notranslate"><span class="pre">means</span></code>, <code class="docutils literal notranslate"><span class="pre">covs</span></code>, and <code class="docutils literal notranslate"><span class="pre">priors</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – Provides <code class="docutils literal notranslate"><span class="pre">α(t)</span></code> and <code class="docutils literal notranslate"><span class="pre">σ(t)</span></code>.</p></li>
<li><p><strong>means</strong> (<code class="docutils literal notranslate"><span class="pre">Array[num_components,</span> <span class="pre">data_dim]</span></code>) – Means of the GMM components.</p></li>
<li><p><strong>variances</strong> (<code class="docutils literal notranslate"><span class="pre">Array[num_components]</span></code>) – Covariances of the GMM components.</p></li>
<li><p><strong>priors</strong> (<code class="docutils literal notranslate"><span class="pre">Array[num_components]</span></code>) – Mixture weights of the GMM components.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The denoised prediction <code class="docutils literal notranslate"><span class="pre">x0</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-diffusionlab.distributions.gmm.iso_hom_gmm">
<span id="diffusionlab-distributions-gmm-iso-hom-gmm"></span><h4><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.gmm.iso_hom_gmm</span></code><a class="headerlink" href="#module-diffusionlab.distributions.gmm.iso_hom_gmm" title="Link to this heading">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.distributions.gmm.iso_hom_gmm.</span></span><span class="sig-name descname"><span class="pre">IsoHomGMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">means</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/iso_hom_gmm.html#IsoHomGMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#diffusionlab.distributions.base.Distribution" title="diffusionlab.distributions.base.Distribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></a></p>
<p>Implements an isotropic homoscedastic Gaussian Mixture Model (GMM) distribution.</p>
<p>The probability measure is given by:</p>
<p><code class="docutils literal notranslate"><span class="pre">μ(A)</span> <span class="pre">=</span> <span class="pre">sum_{i=1}^{num_components}</span> <span class="pre">priors[i]</span> <span class="pre">*</span> <span class="pre">N(A;</span> <span class="pre">means[i],</span> <span class="pre">variance</span> <span class="pre">*</span> <span class="pre">I)</span></code></p>
<p>This class provides methods for sampling from the isotropic homoscedastic GMM and computing various vector fields (<code class="docutils literal notranslate"><span class="pre">VectorFieldType.SCORE</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.X0</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.EPS</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.V</span></code>) related to the distribution under a given diffusion process.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.dist_params">
<span class="sig-name descname"><span class="pre">dist_params</span></span><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.dist_params" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary containing the core GMM parameters.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">means</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[num_components,</span> <span class="pre">data_dim]</span></code>): The means of the GMM components.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">variance</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>): The variance of the GMM components.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">priors</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[num_components]</span></code>): The prior probabilities (mixture weights) of the GMM components.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Array]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.dist_hparams">
<span class="sig-name descname"><span class="pre">dist_hparams</span></span><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.dist_hparams" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary for storing hyperparameters (currently unused).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.eps">
<span class="sig-name descname"><span class="pre">eps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/iso_hom_gmm.html#IsoHomGMM.eps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.eps" title="Link to this definition">¶</a></dt>
<dd><p>Computes the noise prediction <code class="docutils literal notranslate"><span class="pre">ε</span></code> for the isotropic homoscedastic GMM distribution.</p>
<p>This predicts the noise that was added to the original sample <code class="docutils literal notranslate"><span class="pre">x_0</span></code> to obtain <code class="docutils literal notranslate"><span class="pre">x_t</span></code>
at time <code class="docutils literal notranslate"><span class="pre">t</span></code> under the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The noise prediction vector field <code class="docutils literal notranslate"><span class="pre">ε</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/iso_hom_gmm.html#IsoHomGMM.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.sample" title="Link to this definition">¶</a></dt>
<dd><p>Draws samples from the isotropic homoscedastic GMM distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<code class="docutils literal notranslate"><span class="pre">Array</span></code>) – JAX PRNG key for random sampling.</p></li>
<li><p><strong>num_samples</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – The total number of samples to generate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(samples,</span> <span class="pre">component_indices)</span></code> containing the drawn samples and the index of the GMM component from which each sample was drawn.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Tuple[Array[num_samples,</span> <span class="pre">data_dim],</span> <span class="pre">Array[num_samples]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/iso_hom_gmm.html#IsoHomGMM.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.score" title="Link to this definition">¶</a></dt>
<dd><p>Computes the score vector field <code class="docutils literal notranslate"><span class="pre">∇_x</span> <span class="pre">log</span> <span class="pre">p_t(x_t)</span></code> for the isotropic homoscedastic GMM distribution.</p>
<p>This is calculated with respect to the perturbed distribution p_t induced by the
<cite>diffusion_process</cite> at time <cite>t</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score vector field evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.v">
<span class="sig-name descname"><span class="pre">v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/iso_hom_gmm.html#IsoHomGMM.v"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.v" title="Link to this definition">¶</a></dt>
<dd><p>Computes the velocity vector field <code class="docutils literal notranslate"><span class="pre">v</span></code> for the isotropic homoscedastic GMM distribution.</p>
<p>This is conditional velocity <code class="docutils literal notranslate"><span class="pre">E[dx_t/dt</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> under the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The velocity vector field <code class="docutils literal notranslate"><span class="pre">v</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/iso_hom_gmm.html#IsoHomGMM.x0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.x0" title="Link to this definition">¶</a></dt>
<dd><p>Computes the denoised prediction <code class="docutils literal notranslate"><span class="pre">x0</span> <span class="pre">=</span> <span class="pre">E[x_0</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> for the isotropic homoscedastic GMM distribution.</p>
<p>This represents the expected original sample <code class="docutils literal notranslate"><span class="pre">x_0</span></code> given the noisy observation <code class="docutils literal notranslate"><span class="pre">x_t</span></code>
at time <code class="docutils literal notranslate"><span class="pre">t</span></code> under the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The denoised prediction vector field <code class="docutils literal notranslate"><span class="pre">x0</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.iso_hom_gmm.iso_hom_gmm_x0">
<span class="sig-prename descclassname"><span class="pre">diffusionlab.distributions.gmm.iso_hom_gmm.</span></span><span class="sig-name descname"><span class="pre">iso_hom_gmm_x0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">means</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/iso_hom_gmm.html#iso_hom_gmm_x0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.iso_hom_gmm.iso_hom_gmm_x0" title="Link to this definition">¶</a></dt>
<dd><p>Computes the denoised prediction <code class="docutils literal notranslate"><span class="pre">x0</span> <span class="pre">=</span> <span class="pre">E[x_0</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> for an isotropic homoscedastic GMM.</p>
<p>This implements the closed-form solution for the conditional expectation
<code class="docutils literal notranslate"><span class="pre">E[x_0</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> where <code class="docutils literal notranslate"><span class="pre">x_t</span> <span class="pre">~</span> <span class="pre">N(α_t</span> <span class="pre">x_0,</span> <span class="pre">σ_t^2</span> <span class="pre">I)</span></code> and <code class="docutils literal notranslate"><span class="pre">x_0</span></code> follows the GMM distribution
defined by <code class="docutils literal notranslate"><span class="pre">means</span></code>, <code class="docutils literal notranslate"><span class="pre">variance</span></code>, and <code class="docutils literal notranslate"><span class="pre">priors</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – Provides <code class="docutils literal notranslate"><span class="pre">α(t)</span></code> and <code class="docutils literal notranslate"><span class="pre">σ(t)</span></code>.</p></li>
<li><p><strong>means</strong> (<code class="docutils literal notranslate"><span class="pre">Array[num_components,</span> <span class="pre">data_dim]</span></code>) – Means of the GMM components.</p></li>
<li><p><strong>variance</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – Covariance of the GMM components.</p></li>
<li><p><strong>priors</strong> (<code class="docutils literal notranslate"><span class="pre">Array[num_components]</span></code>) – Mixture weights of the GMM components.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The denoised prediction <code class="docutils literal notranslate"><span class="pre">x0</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-diffusionlab.distributions.gmm.low_rank_gmm">
<span id="diffusionlab-distributions-gmm-low-rank-gmm"></span><h4><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.gmm.low_rank_gmm</span></code><a class="headerlink" href="#module-diffusionlab.distributions.gmm.low_rank_gmm" title="Link to this heading">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.distributions.gmm.low_rank_gmm.</span></span><span class="sig-name descname"><span class="pre">LowRankGMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">means</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_factors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/low_rank_gmm.html#LowRankGMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#diffusionlab.distributions.base.Distribution" title="diffusionlab.distributions.base.Distribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></a></p>
<p>Implements a low-rank Gaussian Mixture Model (GMM) distribution.</p>
<p>The probability measure is given by:</p>
<p><code class="docutils literal notranslate"><span class="pre">μ(A)</span> <span class="pre">=</span> <span class="pre">sum_{i=1}^{num_components}</span> <span class="pre">priors[i]</span> <span class="pre">*</span> <span class="pre">N(A;</span> <span class="pre">means[i],</span> <span class="pre">cov_factors[i]</span> <span class="pre">&#64;</span> <span class="pre">cov_factors[i].T)</span></code></p>
<p>This class provides methods for sampling from the GMM and computing various vector fields (<code class="docutils literal notranslate"><span class="pre">VectorFieldType.SCORE</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.X0</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.EPS</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.V</span></code>) related to the distribution under a given diffusion process.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.dist_params">
<span class="sig-name descname"><span class="pre">dist_params</span></span><a class="headerlink" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.dist_params" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary containing the core low-rank GMM parameters.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">means</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[num_components,</span> <span class="pre">data_dim]</span></code>): The means of the GMM components.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cov_factors</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[num_components,</span> <span class="pre">data_dim,</span> <span class="pre">rank]</span></code>): The low-rank covariance matrix factors of the GMM components.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">priors</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[num_components]</span></code>): The prior probabilities (mixture weights) of the GMM components.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Array]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.dist_hparams">
<span class="sig-name descname"><span class="pre">dist_hparams</span></span><a class="headerlink" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.dist_hparams" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary for storing hyperparameters (currently unused).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.eps">
<span class="sig-name descname"><span class="pre">eps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/low_rank_gmm.html#LowRankGMM.eps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.eps" title="Link to this definition">¶</a></dt>
<dd><p>Computes the noise prediction ε for the low-rank GMM distribution.</p>
<p>This predicts the noise that was added to the original sample <code class="docutils literal notranslate"><span class="pre">x_0</span></code> to obtain <code class="docutils literal notranslate"><span class="pre">x_t</span></code>
at time <code class="docutils literal notranslate"><span class="pre">t</span></code> under the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The noise prediction vector field <code class="docutils literal notranslate"><span class="pre">ε</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/low_rank_gmm.html#LowRankGMM.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.sample" title="Link to this definition">¶</a></dt>
<dd><p>Draws samples from the low-rank GMM distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<code class="docutils literal notranslate"><span class="pre">Array</span></code>) – JAX PRNG key for random sampling.</p></li>
<li><p><strong>num_samples</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) – The total number of samples to generate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(samples,</span> <span class="pre">component_indices)</span></code> containing the drawn samples and the index of the GMM component from which each sample was drawn.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Tuple[Array[num_samples,</span> <span class="pre">data_dim],</span> <span class="pre">Array[num_samples]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/low_rank_gmm.html#LowRankGMM.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.score" title="Link to this definition">¶</a></dt>
<dd><p>Computes the score vector field <code class="docutils literal notranslate"><span class="pre">∇_x</span> <span class="pre">log</span> <span class="pre">p_t(x_t)</span></code> for the low-rank GMM distribution.</p>
<p>This is calculated with respect to the perturbed distribution <code class="docutils literal notranslate"><span class="pre">p_t</span></code> induced by the
<code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code> at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score vector field evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.v">
<span class="sig-name descname"><span class="pre">v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/low_rank_gmm.html#LowRankGMM.v"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.v" title="Link to this definition">¶</a></dt>
<dd><p>Computes the velocity vector field <code class="docutils literal notranslate"><span class="pre">v</span></code> for the low-rank GMM distribution.</p>
<p>This is the conditional velocity <code class="docutils literal notranslate"><span class="pre">E[dx_t/dt</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> under the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The velocity vector field <code class="docutils literal notranslate"><span class="pre">v</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/low_rank_gmm.html#LowRankGMM.x0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.x0" title="Link to this definition">¶</a></dt>
<dd><p>Computes the denoised prediction x0 = E[x_0 | x_t] for the low-rank GMM distribution.</p>
<p>This represents the expected original sample <code class="docutils literal notranslate"><span class="pre">x_0</span></code> given the noisy observation <code class="docutils literal notranslate"><span class="pre">x_t</span></code>
at time <code class="docutils literal notranslate"><span class="pre">t</span></code> under the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – The diffusion process definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The denoised prediction vector field <code class="docutils literal notranslate"><span class="pre">x0</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.low_rank_gmm.low_rank_gmm_x0">
<span class="sig-prename descclassname"><span class="pre">diffusionlab.distributions.gmm.low_rank_gmm.</span></span><span class="sig-name descname"><span class="pre">low_rank_gmm_x0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">means</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_factors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/low_rank_gmm.html#low_rank_gmm_x0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.low_rank_gmm.low_rank_gmm_x0" title="Link to this definition">¶</a></dt>
<dd><p>Computes the denoised prediction <code class="docutils literal notranslate"><span class="pre">x0</span> <span class="pre">=</span> <span class="pre">E[x_0</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> for a low-rank GMM.</p>
<p>This implements the closed-form solution for the conditional expectation
<code class="docutils literal notranslate"><span class="pre">E[x_0</span> <span class="pre">|</span> <span class="pre">x_t]</span></code> where <code class="docutils literal notranslate"><span class="pre">x_t</span> <span class="pre">~</span> <span class="pre">N(α_t</span> <span class="pre">x_0,</span> <span class="pre">σ_t^2</span> <span class="pre">I)</span></code> and <code class="docutils literal notranslate"><span class="pre">x_0</span></code> follows the low-rank GMM distribution
defined by <code class="docutils literal notranslate"><span class="pre">means</span></code>, <code class="docutils literal notranslate"><span class="pre">cov_factors</span></code>, and <code class="docutils literal notranslate"><span class="pre">priors</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code>) – The noisy state tensor at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The time step (scalar).</p></li>
<li><p><strong>diffusion_process</strong> (<code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code>) – Provides <code class="docutils literal notranslate"><span class="pre">α(t)</span></code> and <code class="docutils literal notranslate"><span class="pre">σ(t)</span></code>.</p></li>
<li><p><strong>means</strong> (<code class="docutils literal notranslate"><span class="pre">Array[num_components,</span> <span class="pre">data_dim]</span></code>) – Means of the GMM components.</p></li>
<li><p><strong>cov_factors</strong> (<code class="docutils literal notranslate"><span class="pre">Array[num_components,</span> <span class="pre">data_dim,</span> <span class="pre">rank]</span></code>) – Low-rank covariance matrices of the GMM components.</p></li>
<li><p><strong>priors</strong> (<code class="docutils literal notranslate"><span class="pre">Array[num_components]</span></code>) – Mixture weights of the GMM components.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The denoised prediction <code class="docutils literal notranslate"><span class="pre">x0</span></code> evaluated at <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[data_dim]</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-diffusionlab.distributions.gmm.utils">
<span id="diffusionlab-distributions-gmm-utils"></span><h4><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.gmm.utils</span></code><a class="headerlink" href="#module-diffusionlab.distributions.gmm.utils" title="Link to this heading">¶</a></h4>
<dl class="py function">
<dt class="sig sig-object py" id="diffusionlab.distributions.gmm.utils.create_gmm_vector_field_fns">
<span class="sig-prename descclassname"><span class="pre">diffusionlab.distributions.gmm.utils.</span></span><span class="sig-name descname"><span class="pre">create_gmm_vector_field_fns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/diffusionlab/distributions/gmm/utils.html#create_gmm_vector_field_fns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.distributions.gmm.utils.create_gmm_vector_field_fns" title="Link to this definition">¶</a></dt>
<dd><p>Factory to create eps, score, and v functions from a given x0 function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x0_fn</strong> – The specific x0 calculation function (e.g., <code class="docutils literal notranslate"><span class="pre">gmm_x0</span></code>, <code class="docutils literal notranslate"><span class="pre">iso_gmm_x0</span></code>).
It must accept <code class="docutils literal notranslate"><span class="pre">(x_t,</span> <span class="pre">t,</span> <span class="pre">diffusion_process,</span> <span class="pre">means,</span> <span class="pre">specific_cov,</span> <span class="pre">priors)</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the generated <code class="docutils literal notranslate"><span class="pre">(eps_fn,</span> <span class="pre">score_fn,</span> <span class="pre">v_fn)</span></code>.
These functions will have the same signature as <code class="docutils literal notranslate"><span class="pre">x0_fn</span></code>, accepting
<code class="docutils literal notranslate"><span class="pre">(x_t,</span> <span class="pre">t,</span> <span class="pre">diffusion_process,</span> <span class="pre">means,</span> <span class="pre">specific_cov,</span> <span class="pre">priors)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Tuple[Callable[[Array,</span> <span class="pre">Array,</span> <span class="pre">DiffusionProcess,</span> <span class="pre">Array,</span> <span class="pre">Array,</span> <span class="pre">Array],</span> <span class="pre">Array],</span> <span class="pre">Callable[[Array,</span> <span class="pre">Array,</span> <span class="pre">DiffusionProcess,</span> <span class="pre">Array,</span> <span class="pre">Array,</span> <span class="pre">Array],</span> <span class="pre">Array],</span> <span class="pre">Callable[[Array,</span> <span class="pre">Array,</span> <span class="pre">DiffusionProcess,</span> <span class="pre">Array,</span> <span class="pre">Array,</span> <span class="pre">Array],</span> <span class="pre">Array]]</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>
<section id="module-diffusionlab.dynamics">
<span id="diffusionlab-dynamics"></span><h2><code class="docutils literal notranslate"><span class="pre">diffusionlab.dynamics</span></code><a class="headerlink" href="#module-diffusionlab.dynamics" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.dynamics.DiffusionProcess">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.dynamics.</span></span><span class="sig-name descname"><span class="pre">DiffusionProcess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/diffusionlab/dynamics.html#DiffusionProcess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.dynamics.DiffusionProcess" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for implementing various diffusion processes.</p>
<p>A diffusion process defines how data evolves over time when noise is added according to
specific dynamics operating on scalar time inputs. This class provides a framework to
implement diffusion processes based on a schedule defined by <code class="docutils literal notranslate"><span class="pre">α(t)</span></code> and <code class="docutils literal notranslate"><span class="pre">σ(t)</span></code>.</p>
<p>The diffusion is parameterized by two scalar functions of scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">α(t)</span></code>: Controls how much of the original signal is preserved at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">σ(t)</span></code>: Controls how much noise is added at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
</ul>
<p>The forward process for a single data point <code class="docutils literal notranslate"><span class="pre">x_0</span></code> is defined as:</p>
<p><code class="docutils literal notranslate"><span class="pre">x_t</span> <span class="pre">=</span> <span class="pre">α(t)</span> <span class="pre">*</span> <span class="pre">x_0</span> <span class="pre">+</span> <span class="pre">σ(t)</span> <span class="pre">*</span> <span class="pre">ε</span></code></p>
<p>where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x_0</span></code> is the original data (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x_t</span></code> is the noised data at time <code class="docutils literal notranslate"><span class="pre">t</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ε</span></code> is random noise sampled from a standard Gaussian distribution (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> is the scalar diffusion time parameter (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>)</p></li>
</ul>
<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.DiffusionProcess.alpha">
<span class="sig-name descname"><span class="pre">alpha</span></span><a class="headerlink" href="#diffusionlab.dynamics.DiffusionProcess.alpha" title="Link to this definition">¶</a></dt>
<dd><p>Function mapping scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code> -&gt; scalar signal coefficient <code class="docutils literal notranslate"><span class="pre">α(t)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.DiffusionProcess.sigma">
<span class="sig-name descname"><span class="pre">sigma</span></span><a class="headerlink" href="#diffusionlab.dynamics.DiffusionProcess.sigma" title="Link to this definition">¶</a></dt>
<dd><p>Function mapping scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code> -&gt; scalar noise coefficient <code class="docutils literal notranslate"><span class="pre">σ(t)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.DiffusionProcess.alpha_prime">
<span class="sig-name descname"><span class="pre">alpha_prime</span></span><a class="headerlink" href="#diffusionlab.dynamics.DiffusionProcess.alpha_prime" title="Link to this definition">¶</a></dt>
<dd><p>Derivative of <code class="docutils literal notranslate"><span class="pre">α</span></code> w.r.t. scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.DiffusionProcess.sigma_prime">
<span class="sig-name descname"><span class="pre">sigma_prime</span></span><a class="headerlink" href="#diffusionlab.dynamics.DiffusionProcess.sigma_prime" title="Link to this definition">¶</a></dt>
<dd><p>Derivative of <code class="docutils literal notranslate"><span class="pre">σ</span></code> w.r.t. scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.dynamics.DiffusionProcess.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/dynamics.html#DiffusionProcess.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.dynamics.DiffusionProcess.forward" title="Link to this definition">¶</a></dt>
<dd><p>Applies the forward diffusion process to a data tensor <code class="docutils literal notranslate"><span class="pre">x</span></code> at time <code class="docutils literal notranslate"><span class="pre">t</span></code> using noise <code class="docutils literal notranslate"><span class="pre">ε</span></code>.</p>
<p>Computes <code class="docutils literal notranslate"><span class="pre">x_t</span> <span class="pre">=</span> <span class="pre">α(t)</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">σ(t)</span> <span class="pre">*</span> <span class="pre">ε</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The input data tensor <code class="docutils literal notranslate"><span class="pre">x_0</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The scalar time parameter <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>eps</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The Gaussian noise tensor <code class="docutils literal notranslate"><span class="pre">ε</span></code>, matching the shape of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The noised data tensor <code class="docutils literal notranslate"><span class="pre">x_t</span></code> at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.dynamics.FlowMatchingProcess">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.dynamics.</span></span><span class="sig-name descname"><span class="pre">FlowMatchingProcess</span></span><a class="reference internal" href="_modules/diffusionlab/dynamics.html#FlowMatchingProcess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.dynamics.FlowMatchingProcess" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffusionProcess</span></code></a></p>
<p>Implements a diffusion process based on Flow Matching principles.</p>
<p>This process defines dynamics that linearly interpolate between the data distribution
at <code class="docutils literal notranslate"><span class="pre">t=0</span></code> and a noise distribution (standard Gaussian) at <code class="docutils literal notranslate"><span class="pre">t=1</span></code>.</p>
<p>Uses the following scalar dynamics:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">α(t)</span> <span class="pre">=</span> <span class="pre">1</span> <span class="pre">-</span> <span class="pre">t</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">σ(t)</span> <span class="pre">=</span> <span class="pre">t</span></code></p></li>
</ul>
<p>Forward process:</p>
<p><code class="docutils literal notranslate"><span class="pre">x_t</span> <span class="pre">=</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">t)</span> <span class="pre">*</span> <span class="pre">x_0</span> <span class="pre">+</span> <span class="pre">t</span> <span class="pre">*</span> <span class="pre">ε</span></code>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.FlowMatchingProcess.alpha">
<span class="sig-name descname"><span class="pre">alpha</span></span><a class="headerlink" href="#diffusionlab.dynamics.FlowMatchingProcess.alpha" title="Link to this definition">¶</a></dt>
<dd><p>Function mapping scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code> -&gt; scalar signal coefficient <code class="docutils literal notranslate"><span class="pre">α(t)</span></code>. Set to <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">t</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.FlowMatchingProcess.sigma">
<span class="sig-name descname"><span class="pre">sigma</span></span><a class="headerlink" href="#diffusionlab.dynamics.FlowMatchingProcess.sigma" title="Link to this definition">¶</a></dt>
<dd><p>Function mapping scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code> -&gt; scalar noise coefficient <code class="docutils literal notranslate"><span class="pre">σ(t)</span></code>. Set to <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.FlowMatchingProcess.alpha_prime">
<span class="sig-name descname"><span class="pre">alpha_prime</span></span><a class="headerlink" href="#diffusionlab.dynamics.FlowMatchingProcess.alpha_prime" title="Link to this definition">¶</a></dt>
<dd><p>Derivative of <code class="docutils literal notranslate"><span class="pre">α</span></code> w.r.t. scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code>. Set to <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.FlowMatchingProcess.sigma_prime">
<span class="sig-name descname"><span class="pre">sigma_prime</span></span><a class="headerlink" href="#diffusionlab.dynamics.FlowMatchingProcess.sigma_prime" title="Link to this definition">¶</a></dt>
<dd><p>Derivative of <code class="docutils literal notranslate"><span class="pre">σ</span></code> w.r.t. scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code>. Set to <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.dynamics.VarianceExplodingProcess">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.dynamics.</span></span><span class="sig-name descname"><span class="pre">VarianceExplodingProcess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/diffusionlab/dynamics.html#VarianceExplodingProcess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.dynamics.VarianceExplodingProcess" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffusionProcess</span></code></a></p>
<p>Implements a Variance Exploding (VE) diffusion process.</p>
<p>In this process, the signal component is constant (<code class="docutils literal notranslate"><span class="pre">α(t)</span> <span class="pre">=</span> <span class="pre">1</span></code>), while the noise component
increases over time according to the provided <code class="docutils literal notranslate"><span class="pre">σ(t)</span></code> function. The variance of the
noised data <code class="docutils literal notranslate"><span class="pre">x_t</span></code> explodes as <code class="docutils literal notranslate"><span class="pre">t</span></code> increases.</p>
<p>Forward process:</p>
<p><code class="docutils literal notranslate"><span class="pre">x_t</span> <span class="pre">=</span> <span class="pre">x_0</span> <span class="pre">+</span> <span class="pre">σ(t)</span> <span class="pre">*</span> <span class="pre">ε</span></code>.</p>
<p>This process uses:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">α(t)</span> <span class="pre">=</span> <span class="pre">1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">σ(t)</span> <span class="pre">=</span></code> Provided by the user</p></li>
</ul>
<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.VarianceExplodingProcess.alpha">
<span class="sig-name descname"><span class="pre">alpha</span></span><a class="headerlink" href="#diffusionlab.dynamics.VarianceExplodingProcess.alpha" title="Link to this definition">¶</a></dt>
<dd><p>Function mapping scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code> -&gt; scalar signal coefficient <code class="docutils literal notranslate"><span class="pre">α(t)</span></code>. Set to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.VarianceExplodingProcess.sigma">
<span class="sig-name descname"><span class="pre">sigma</span></span><a class="headerlink" href="#diffusionlab.dynamics.VarianceExplodingProcess.sigma" title="Link to this definition">¶</a></dt>
<dd><p>Function mapping scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code> -&gt; scalar noise coefficient <code class="docutils literal notranslate"><span class="pre">σ(t)</span></code>. Provided by the user.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.VarianceExplodingProcess.alpha_prime">
<span class="sig-name descname"><span class="pre">alpha_prime</span></span><a class="headerlink" href="#diffusionlab.dynamics.VarianceExplodingProcess.alpha_prime" title="Link to this definition">¶</a></dt>
<dd><p>Derivative of <code class="docutils literal notranslate"><span class="pre">α</span></code> w.r.t. scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code>. Set to 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.VarianceExplodingProcess.sigma_prime">
<span class="sig-name descname"><span class="pre">sigma_prime</span></span><a class="headerlink" href="#diffusionlab.dynamics.VarianceExplodingProcess.sigma_prime" title="Link to this definition">¶</a></dt>
<dd><p>Derivative of <code class="docutils literal notranslate"><span class="pre">σ</span></code> w.r.t. scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.dynamics.VariancePreservingProcess">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.dynamics.</span></span><span class="sig-name descname"><span class="pre">VariancePreservingProcess</span></span><a class="reference internal" href="_modules/diffusionlab/dynamics.html#VariancePreservingProcess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.dynamics.VariancePreservingProcess" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffusionProcess</span></code></a></p>
<p>Implements a Variance Preserving (VP) diffusion process, often used in DDPMs.</p>
<p>This process maintains the variance of the noised data <code class="docutils literal notranslate"><span class="pre">x_t</span></code> close to 1 (assuming <code class="docutils literal notranslate"><span class="pre">x_0</span></code>
and <code class="docutils literal notranslate"><span class="pre">ε</span></code> have unit variance) throughout the diffusion by scaling the signal and noise
components appropriately.</p>
<p>Uses the following scalar dynamics:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">α(t)</span> <span class="pre">=</span> <span class="pre">sqrt(1</span> <span class="pre">-</span> <span class="pre">t²)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">σ(t)</span> <span class="pre">=</span> <span class="pre">t</span></code></p></li>
</ul>
<p>Forward process:</p>
<p><code class="docutils literal notranslate"><span class="pre">x_t</span> <span class="pre">=</span> <span class="pre">sqrt(1</span> <span class="pre">-</span> <span class="pre">t²)</span> <span class="pre">*</span> <span class="pre">x_0</span> <span class="pre">+</span> <span class="pre">t</span> <span class="pre">*</span> <span class="pre">ε</span></code>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.VariancePreservingProcess.alpha">
<span class="sig-name descname"><span class="pre">alpha</span></span><a class="headerlink" href="#diffusionlab.dynamics.VariancePreservingProcess.alpha" title="Link to this definition">¶</a></dt>
<dd><p>Function mapping scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code> -&gt; scalar signal coefficient <code class="docutils literal notranslate"><span class="pre">α(t)</span></code>. Set to <code class="docutils literal notranslate"><span class="pre">sqrt(1</span> <span class="pre">-</span> <span class="pre">t²)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.VariancePreservingProcess.sigma">
<span class="sig-name descname"><span class="pre">sigma</span></span><a class="headerlink" href="#diffusionlab.dynamics.VariancePreservingProcess.sigma" title="Link to this definition">¶</a></dt>
<dd><p>Function mapping scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code> -&gt; scalar noise coefficient <code class="docutils literal notranslate"><span class="pre">σ(t)</span></code>. Set to <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.VariancePreservingProcess.alpha_prime">
<span class="sig-name descname"><span class="pre">alpha_prime</span></span><a class="headerlink" href="#diffusionlab.dynamics.VariancePreservingProcess.alpha_prime" title="Link to this definition">¶</a></dt>
<dd><p>Derivative of <code class="docutils literal notranslate"><span class="pre">α</span></code> w.r.t. scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code>. Set to <code class="docutils literal notranslate"><span class="pre">-t</span> <span class="pre">/</span> <span class="pre">sqrt(1</span> <span class="pre">-</span> <span class="pre">t²)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.dynamics.VariancePreservingProcess.sigma_prime">
<span class="sig-name descname"><span class="pre">sigma_prime</span></span><a class="headerlink" href="#diffusionlab.dynamics.VariancePreservingProcess.sigma_prime" title="Link to this definition">¶</a></dt>
<dd><p>Derivative of <code class="docutils literal notranslate"><span class="pre">σ</span></code> w.r.t. scalar time <code class="docutils literal notranslate"><span class="pre">t</span></code>. Set to <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[]],</span> <span class="pre">Array[]]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-diffusionlab.losses">
<span id="diffusionlab-losses"></span><h2><code class="docutils literal notranslate"><span class="pre">diffusionlab.losses</span></code><a class="headerlink" href="#module-diffusionlab.losses" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.losses.DiffusionLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.losses.</span></span><span class="sig-name descname"><span class="pre">DiffusionLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_field_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.vector_fields.VectorFieldType" title="diffusionlab.vector_fields.VectorFieldType"><span class="pre">VectorFieldType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_noise_draws_per_sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/diffusionlab/losses.html#DiffusionLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.losses.DiffusionLoss" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Loss function for training diffusion models.</p>
<p>This dataclass implements various loss functions for diffusion models based on the specified
target type. The loss is computed as the mean squared error between the model’s prediction
and the target, which depends on the chosen vector field type.</p>
<p>The loss supports different target types:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">VectorFieldType.X0</span></code>: Learn to predict the original clean data x_0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VectorFieldType.EPS</span></code>: Learn to predict the noise component eps</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VectorFieldType.V</span></code>: Learn to predict the velocity field v</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VectorFieldType.SCORE</span></code>: Not directly supported (raises ValueError)</p></li>
</ul>
<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.losses.DiffusionLoss.diffusion_process">
<span class="sig-name descname"><span class="pre">diffusion_process</span></span><a class="headerlink" href="#diffusionlab.losses.DiffusionLoss.diffusion_process" title="Link to this definition">¶</a></dt>
<dd><p>The diffusion process defining the forward dynamics</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.losses.DiffusionLoss.vector_field_type">
<span class="sig-name descname"><span class="pre">vector_field_type</span></span><a class="headerlink" href="#diffusionlab.losses.DiffusionLoss.vector_field_type" title="Link to this definition">¶</a></dt>
<dd><p>The type of target to learn to estimate via minimizing the loss function.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">VectorFieldType</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.losses.DiffusionLoss.num_noise_draws_per_sample">
<span class="sig-name descname"><span class="pre">num_noise_draws_per_sample</span></span><a class="headerlink" href="#diffusionlab.losses.DiffusionLoss.num_noise_draws_per_sample" title="Link to this definition">¶</a></dt>
<dd><p>The number of noise draws per sample to use for the batchwise loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.losses.DiffusionLoss.target">
<span class="sig-name descname"><span class="pre">target</span></span><a class="headerlink" href="#diffusionlab.losses.DiffusionLoss.target" title="Link to this definition">¶</a></dt>
<dd><p>Function that computes the target based on the specified target_type.</p>
<p>Signature: <code class="docutils literal notranslate"><span class="pre">(x_t:</span> <span class="pre">Array[*data_dims],</span> <span class="pre">f_x_t:</span> <span class="pre">Array[*data_dims],</span> <span class="pre">x_0:</span> <span class="pre">Array[*data_dims],</span> <span class="pre">eps:</span> <span class="pre">Array[*data_dims],</span> <span class="pre">t:</span> <span class="pre">Array[])</span> <span class="pre">-&gt;</span> <span class="pre">Array[*data_dims]</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array,</span> <span class="pre">Array,</span> <span class="pre">Array,</span> <span class="pre">Array,</span> <span class="pre">Array],</span> <span class="pre">Array]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.losses.DiffusionLoss.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/losses.html#DiffusionLoss.loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.losses.DiffusionLoss.loss" title="Link to this definition">¶</a></dt>
<dd><p>Compute the average loss over multiple noise draws for a single data point and time.</p>
<p>This method estimates the expected loss at a given time <code class="docutils literal notranslate"><span class="pre">t</span></code> for a clean data sample <code class="docutils literal notranslate"><span class="pre">x_0</span></code>.
It does this by drawing <code class="docutils literal notranslate"><span class="pre">num_noise_draws_per_sample</span></code> noise vectors (<code class="docutils literal notranslate"><span class="pre">eps</span></code>), generating
the corresponding noisy samples <code class="docutils literal notranslate"><span class="pre">x_t</span></code> using the <code class="docutils literal notranslate"><span class="pre">diffusion_process</span></code>, predicting the
target quantity <code class="docutils literal notranslate"><span class="pre">f_x_t</span></code> using the provided <code class="docutils literal notranslate"><span class="pre">vector_field</span></code> (vmapped internally), and then calculating the
<code class="docutils literal notranslate"><span class="pre">prediction_loss</span></code> for each noise sample. The final loss is the average over these samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<code class="docutils literal notranslate"><span class="pre">Array</span></code>) – The PRNG key for noise generation.</p></li>
<li><p><strong>vector_field</strong> (<code class="docutils literal notranslate"><span class="pre">Callable[[Array,</span> <span class="pre">Array],</span> <span class="pre">Array]</span></code>) – <p>The vector field function that takes
a single noisy data sample <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and its corresponding time <code class="docutils literal notranslate"><span class="pre">t</span></code>, and returns the model’s prediction <code class="docutils literal notranslate"><span class="pre">f_x_t</span></code>.
This function will be vmapped internally over the batch dimension created by <code class="docutils literal notranslate"><span class="pre">num_noise_draws_per_sample</span></code>.</p>
<p>Signature: <code class="docutils literal notranslate"><span class="pre">(x_t:</span> <span class="pre">Array[*data_dims],</span> <span class="pre">t:</span> <span class="pre">Array[])</span> <span class="pre">-&gt;</span> <span class="pre">Array[*data_dims]</span></code>.</p>
</p></li>
<li><p><strong>x_0</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The original clean data sample.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The scalar time parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The scalar loss value, averaged over <code class="docutils literal notranslate"><span class="pre">num_noise_draws_per_sample</span></code> noise instances.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.losses.DiffusionLoss.prediction_loss">
<span class="sig-name descname"><span class="pre">prediction_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_x_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/losses.html#DiffusionLoss.prediction_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.losses.DiffusionLoss.prediction_loss" title="Link to this definition">¶</a></dt>
<dd><p>Compute the loss given a prediction and inputs/targets.</p>
<p>This method calculates the mean squared error between the model’s prediction (<code class="docutils literal notranslate"><span class="pre">f_x_t</span></code>)
and the target value determined by the target_type (<code class="docutils literal notranslate"><span class="pre">self.target</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The noised data at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>f_x_t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The model’s prediction at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>x_0</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The original clean data.</p></li>
<li><p><strong>eps</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The noise used to generate <code class="docutils literal notranslate"><span class="pre">x_t</span></code>.</p></li>
<li><p><strong>t</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – The scalar time parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The scalar loss value for the given sample.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-diffusionlab.samplers">
<span id="diffusionlab-samplers"></span><h2><code class="docutils literal notranslate"><span class="pre">diffusionlab.samplers</span></code><a class="headerlink" href="#module-diffusionlab.samplers" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.samplers.DDMSampler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.samplers.</span></span><span class="sig-name descname"><span class="pre">DDMSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_field_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.vector_fields.VectorFieldType" title="diffusionlab.vector_fields.VectorFieldType"><span class="pre">VectorFieldType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_stochastic_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/diffusionlab/samplers.html#DDMSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.samplers.DDMSampler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#diffusionlab.samplers.Sampler" title="diffusionlab.samplers.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a></p>
<p>Class for sampling from diffusion models using the Denoising Diffusion Probabilistic Models (DDPM)
or Denoising Diffusion Implicit Models (DDIM) sampling strategy.</p>
<p>This sampler first converts any given vector field type (<code class="docutils literal notranslate"><span class="pre">VectorFieldType.SCORE</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.X0</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.EPS</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.V</span></code>) provided by <code class="docutils literal notranslate"><span class="pre">vector_field</span></code> into an equivalent x0 prediction using the <code class="docutils literal notranslate"><span class="pre">convert_vector_field_type</span></code> utility.
Then, it applies the DDPM (if <code class="docutils literal notranslate"><span class="pre">use_stochastic_sampler</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>) or DDIM (if <code class="docutils literal notranslate"><span class="pre">use_stochastic_sampler</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>) update rule based on this x0 prediction.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.samplers.DDMSampler.diffusion_process">
<span class="sig-name descname"><span class="pre">diffusion_process</span></span><a class="headerlink" href="#diffusionlab.samplers.DDMSampler.diffusion_process" title="Link to this definition">¶</a></dt>
<dd><p>The diffusion process defining the forward dynamics.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.samplers.DDMSampler.vector_field">
<span class="sig-name descname"><span class="pre">vector_field</span></span><a class="headerlink" href="#diffusionlab.samplers.DDMSampler.vector_field" title="Link to this definition">¶</a></dt>
<dd><p>The function predicting the vector field.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[*data_dims],</span> <span class="pre">Array[]],</span> <span class="pre">Array[*data_dims]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.samplers.DDMSampler.vector_field_type">
<span class="sig-name descname"><span class="pre">vector_field_type</span></span><a class="headerlink" href="#diffusionlab.samplers.DDMSampler.vector_field_type" title="Link to this definition">¶</a></dt>
<dd><p>The type of the vector field predicted by <code class="docutils literal notranslate"><span class="pre">vector_field</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">VectorFieldType</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.samplers.DDMSampler.use_stochastic_sampler">
<span class="sig-name descname"><span class="pre">use_stochastic_sampler</span></span><a class="headerlink" href="#diffusionlab.samplers.DDMSampler.use_stochastic_sampler" title="Link to this definition">¶</a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, uses DDPM (stochastic); otherwise, uses DDIM (deterministic).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.samplers.DDMSampler.sample_step">
<span class="sig-name descname"><span class="pre">sample_step</span></span><a class="headerlink" href="#diffusionlab.samplers.DDMSampler.sample_step" title="Link to this definition">¶</a></dt>
<dd><p>The DDPM or DDIM step function.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[int,</span> <span class="pre">Array,</span> <span class="pre">Array,</span> <span class="pre">Array],</span> <span class="pre">Array]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.samplers.DDMSampler.get_sample_step_function">
<span class="sig-name descname"><span class="pre">get_sample_step_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/diffusionlab/samplers.html#DDMSampler.get_sample_step_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.samplers.DDMSampler.get_sample_step_function" title="Link to this definition">¶</a></dt>
<dd><p>Get the appropriate DDPM/DDIM sampling step function based on stochasticity.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>The DDPM (stochastic) or DDIM (deterministic) step function, which has signature:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">(idx:</span> <span class="pre">int,</span> <span class="pre">x:</span> <span class="pre">Array[*data_dims],</span> <span class="pre">zs:</span> <span class="pre">Array[num_steps,</span> <span class="pre">*data_dims],</span> <span class="pre">ts:</span> <span class="pre">Array[num_steps+1])</span> <span class="pre">-&gt;</span> <span class="pre">Array[*data_dims]</span></code></p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">Callable[[int,</span> <span class="pre">Array,</span> <span class="pre">Array,</span> <span class="pre">Array],</span> <span class="pre">Array]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.samplers.EulerMaruyamaSampler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.samplers.</span></span><span class="sig-name descname"><span class="pre">EulerMaruyamaSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_field_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.vector_fields.VectorFieldType" title="diffusionlab.vector_fields.VectorFieldType"><span class="pre">VectorFieldType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_stochastic_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/diffusionlab/samplers.html#EulerMaruyamaSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.samplers.EulerMaruyamaSampler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#diffusionlab.samplers.Sampler" title="diffusionlab.samplers.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a></p>
<p>Class for sampling from diffusion models using the first-order Euler-Maruyama integrator
for the reverse process SDE/ODE.</p>
<p>This sampler implements the step function based on the Euler-Maruyama discretization
of the reverse SDE (if <code class="docutils literal notranslate"><span class="pre">use_stochastic_sampler</span></code> is True) or the corresponding
probability flow ODE (if <code class="docutils literal notranslate"><span class="pre">use_stochastic_sampler</span></code> is False). It supports all
vector field types (<code class="docutils literal notranslate"><span class="pre">VectorFieldType.SCORE</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.X0</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.EPS</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.V</span></code>).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.samplers.EulerMaruyamaSampler.diffusion_process">
<span class="sig-name descname"><span class="pre">diffusion_process</span></span><a class="headerlink" href="#diffusionlab.samplers.EulerMaruyamaSampler.diffusion_process" title="Link to this definition">¶</a></dt>
<dd><p>The diffusion process defining the forward dynamics.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.samplers.EulerMaruyamaSampler.vector_field">
<span class="sig-name descname"><span class="pre">vector_field</span></span><a class="headerlink" href="#diffusionlab.samplers.EulerMaruyamaSampler.vector_field" title="Link to this definition">¶</a></dt>
<dd><p>The function predicting the vector field.
Takes the current state <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and time <code class="docutils literal notranslate"><span class="pre">t</span></code> as input.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[*data_dims],</span> <span class="pre">Array[]],</span> <span class="pre">Array[*data_dims]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.samplers.EulerMaruyamaSampler.vector_field_type">
<span class="sig-name descname"><span class="pre">vector_field_type</span></span><a class="headerlink" href="#diffusionlab.samplers.EulerMaruyamaSampler.vector_field_type" title="Link to this definition">¶</a></dt>
<dd><p>The type of the vector field predicted by <code class="docutils literal notranslate"><span class="pre">vector_field</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">VectorFieldType</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.samplers.EulerMaruyamaSampler.use_stochastic_sampler">
<span class="sig-name descname"><span class="pre">use_stochastic_sampler</span></span><a class="headerlink" href="#diffusionlab.samplers.EulerMaruyamaSampler.use_stochastic_sampler" title="Link to this definition">¶</a></dt>
<dd><p>Whether to use a stochastic or deterministic reverse process.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.samplers.EulerMaruyamaSampler.sample_step">
<span class="sig-name descname"><span class="pre">sample_step</span></span><a class="headerlink" href="#diffusionlab.samplers.EulerMaruyamaSampler.sample_step" title="Link to this definition">¶</a></dt>
<dd><p>The specific function used to perform one sampling step.
Takes step index <code class="docutils literal notranslate"><span class="pre">idx</span></code>, current state <code class="docutils literal notranslate"><span class="pre">x_t</span></code>, noise array <code class="docutils literal notranslate"><span class="pre">zs</span></code>, and time schedule <code class="docutils literal notranslate"><span class="pre">ts</span></code> as input.
Set during initialization based on the sampler type and <code class="docutils literal notranslate"><span class="pre">use_stochastic_sampler</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[int,</span> <span class="pre">Array,</span> <span class="pre">Array,</span> <span class="pre">Array],</span> <span class="pre">Array]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.samplers.EulerMaruyamaSampler.get_sample_step_function">
<span class="sig-name descname"><span class="pre">get_sample_step_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/diffusionlab/samplers.html#EulerMaruyamaSampler.get_sample_step_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.samplers.EulerMaruyamaSampler.get_sample_step_function" title="Link to this definition">¶</a></dt>
<dd><p>Get the appropriate Euler-Maruyama sampling step function based on the
vector field type and stochasticity.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>The specific Euler-Maruyama step function to use.</p>
<blockquote>
<div><p>Signature: <code class="docutils literal notranslate"><span class="pre">(idx:</span> <span class="pre">int,</span> <span class="pre">x_t:</span> <span class="pre">Array[*data_dims],</span> <span class="pre">zs:</span> <span class="pre">Array[num_steps,</span> <span class="pre">*data_dims],</span> <span class="pre">ts:</span> <span class="pre">Array[num_steps+1])</span> <span class="pre">-&gt;</span> <span class="pre">Array[*data_dims]</span></code></p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Callable[[int, Array, Array, Array], Array]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.samplers.Sampler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.samplers.</span></span><span class="sig-name descname"><span class="pre">Sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diffusion_process</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess" title="diffusionlab.dynamics.DiffusionProcess"><span class="pre">DiffusionProcess</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_field_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.vector_fields.VectorFieldType" title="diffusionlab.vector_fields.VectorFieldType"><span class="pre">VectorFieldType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_stochastic_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/diffusionlab/samplers.html#Sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.samplers.Sampler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for sampling from diffusion models using various vector field types.</p>
<p>A Sampler combines a diffusion process, a vector field prediction function, and a scheduler
to generate samples from a trained diffusion model using the reverse process (denoising/sampling).</p>
<p>The sampler supports different vector field types (<code class="docutils literal notranslate"><span class="pre">VectorFieldType.SCORE</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.X0</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.EPS</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.V</span></code>) and can perform both stochastic and deterministic sampling based on the subclass implementation and the <cite>use_stochastic_sampler`</cite> flag.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.samplers.Sampler.diffusion_process">
<span class="sig-name descname"><span class="pre">diffusion_process</span></span><a class="headerlink" href="#diffusionlab.samplers.Sampler.diffusion_process" title="Link to this definition">¶</a></dt>
<dd><p>The diffusion process defining the forward dynamics.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.samplers.Sampler.vector_field">
<span class="sig-name descname"><span class="pre">vector_field</span></span><a class="headerlink" href="#diffusionlab.samplers.Sampler.vector_field" title="Link to this definition">¶</a></dt>
<dd><p>The function predicting the vector field.
Takes the current state <code class="docutils literal notranslate"><span class="pre">x_t</span></code> and time <code class="docutils literal notranslate"><span class="pre">t</span></code> as input.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[Array[*data_dims],</span> <span class="pre">Array[]],</span> <span class="pre">Array[*data_dims]]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.samplers.Sampler.vector_field_type">
<span class="sig-name descname"><span class="pre">vector_field_type</span></span><a class="headerlink" href="#diffusionlab.samplers.Sampler.vector_field_type" title="Link to this definition">¶</a></dt>
<dd><p>The type of the vector field predicted by <code class="docutils literal notranslate"><span class="pre">vector_field</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">VectorFieldType</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.samplers.Sampler.use_stochastic_sampler">
<span class="sig-name descname"><span class="pre">use_stochastic_sampler</span></span><a class="headerlink" href="#diffusionlab.samplers.Sampler.use_stochastic_sampler" title="Link to this definition">¶</a></dt>
<dd><p>Whether to use a stochastic or deterministic reverse process.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="diffusionlab.samplers.Sampler.sample_step">
<span class="sig-name descname"><span class="pre">sample_step</span></span><a class="headerlink" href="#diffusionlab.samplers.Sampler.sample_step" title="Link to this definition">¶</a></dt>
<dd><p>The specific function used to perform one sampling step.
Takes step index <code class="docutils literal notranslate"><span class="pre">idx</span></code>, current state <code class="docutils literal notranslate"><span class="pre">x_t</span></code>, noise array <code class="docutils literal notranslate"><span class="pre">zs</span></code>, and time schedule <code class="docutils literal notranslate"><span class="pre">ts</span></code> as input.
Set during initialization based on the sampler type and <code class="docutils literal notranslate"><span class="pre">use_stochastic_sampler</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Callable[[int,</span> <span class="pre">Array,</span> <span class="pre">Array,</span> <span class="pre">Array],</span> <span class="pre">Array]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.samplers.Sampler.get_sample_step_function">
<span class="sig-name descname"><span class="pre">get_sample_step_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/diffusionlab/samplers.html#Sampler.get_sample_step_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.samplers.Sampler.get_sample_step_function" title="Link to this definition">¶</a></dt>
<dd><p>Abstract method to get the appropriate sampling step function.</p>
<p>Subclasses must implement this method to return the specific function used
for performing one step of the reverse process, based on the sampler’s
implementation details (e.g., integrator type) and the <code class="docutils literal notranslate"><span class="pre">use_stochastic_sampler</span></code> flag.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>The sampling step function, which has signature:</p>
<p><code class="docutils literal notranslate"><span class="pre">(idx:</span> <span class="pre">int,</span> <span class="pre">x_t:</span> <span class="pre">Array[*data_dims],</span> <span class="pre">zs:</span> <span class="pre">Array[num_steps,</span> <span class="pre">*data_dims],</span> <span class="pre">ts:</span> <span class="pre">Array[num_steps+1])</span> <span class="pre">-&gt;</span> <span class="pre">Array[*data_dims]</span></code></p>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">Callable[[int,</span> <span class="pre">Array,</span> <span class="pre">Array,</span> <span class="pre">Array],</span> <span class="pre">Array]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.samplers.Sampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/samplers.html#Sampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.samplers.Sampler.sample" title="Link to this definition">¶</a></dt>
<dd><p>Sample from the model using the reverse diffusion process.</p>
<p>This method generates a final sample by iteratively applying the <code class="docutils literal notranslate"><span class="pre">sample_step</span></code> function,
starting from an initial state <code class="docutils literal notranslate"><span class="pre">x_init</span></code> and using the provided noise <code class="docutils literal notranslate"><span class="pre">zs</span></code> and time schedule <code class="docutils literal notranslate"><span class="pre">ts</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_init</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The initial noisy tensor from which to initialize sampling (typically sampled from the prior distribution at <code class="docutils literal notranslate"><span class="pre">ts[0]</span></code>).</p></li>
<li><p><strong>zs</strong> (<code class="docutils literal notranslate"><span class="pre">Array[num_steps,</span> <span class="pre">*data_dims]</span></code>) – The noise tensors used at each step for stochastic sampling. Unused for deterministic samplers.</p></li>
<li><p><strong>ts</strong> (<code class="docutils literal notranslate"><span class="pre">Array[num_steps+1]</span></code>) – The time schedule for sampling. A sorted decreasing array of times from <code class="docutils literal notranslate"><span class="pre">t_max</span></code> to <code class="docutils literal notranslate"><span class="pre">t_min</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated sample at the final time <code class="docutils literal notranslate"><span class="pre">ts[-1]</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.samplers.Sampler.sample_trajectory">
<span class="sig-name descname"><span class="pre">sample_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/samplers.html#Sampler.sample_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.samplers.Sampler.sample_trajectory" title="Link to this definition">¶</a></dt>
<dd><p>Sample a trajectory from the model using the reverse diffusion process.</p>
<p>This method generates the entire trajectory of intermediate samples by iteratively
applying the <code class="docutils literal notranslate"><span class="pre">sample_step</span></code> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_init</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The initial noisy tensor from which to start sampling (at time <code class="docutils literal notranslate"><span class="pre">ts[0]</span></code>).</p></li>
<li><p><strong>zs</strong> (<code class="docutils literal notranslate"><span class="pre">Array[num_steps,</span> <span class="pre">*data_dims]</span></code>) – The noise tensors used at each step for stochastic sampling. Unused for deterministic samplers.</p></li>
<li><p><strong>ts</strong> (<code class="docutils literal notranslate"><span class="pre">Array[num_steps+1]</span></code>) – The time schedule for sampling. A sorted decreasing array of times from <code class="docutils literal notranslate"><span class="pre">t_max</span></code> to <code class="docutils literal notranslate"><span class="pre">t_min</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The complete generated trajectory including the initial state <code class="docutils literal notranslate"><span class="pre">x_init</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[num_steps+1,</span> <span class="pre">*data_dims]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-diffusionlab.schedulers">
<span id="diffusionlab-schedulers"></span><h2><code class="docutils literal notranslate"><span class="pre">diffusionlab.schedulers</span></code><a class="headerlink" href="#module-diffusionlab.schedulers" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.schedulers.Scheduler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.schedulers.</span></span><span class="sig-name descname"><span class="pre">Scheduler</span></span><a class="reference internal" href="_modules/diffusionlab/schedulers.html#Scheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.schedulers.Scheduler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for time step schedulers used in diffusion, denoising, and sampling.</p>
<p>Allows for extensible scheduler implementations where subclasses can define
their own initialization and time step generation parameters via <a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs.</p>
<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.schedulers.Scheduler.get_ts">
<span class="sig-name descname"><span class="pre">get_ts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">ts_hparams</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/schedulers.html#Scheduler.get_ts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.schedulers.Scheduler.get_ts" title="Link to this definition">¶</a></dt>
<dd><p>Generate the sequence of time steps.</p>
<p>This is an abstract method that must be implemented by subclasses.
Subclasses should define the specific keyword arguments they expect
within <code class="docutils literal notranslate"><span class="pre">**ts_hparams</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**ts_hparams</strong> (<code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>) – Keyword arguments containing parameters for generating time steps.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor containing the sequence of time steps in descending order.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array</span></code></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>NotImplementedError</strong> – If the subclass does not implement this method.</p></li>
<li><p><strong>KeyError</strong> – If a required parameter is missing in <code class="docutils literal notranslate"><span class="pre">**ts_hparams</span></code> (in subclass).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.schedulers.UniformScheduler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.schedulers.</span></span><span class="sig-name descname"><span class="pre">UniformScheduler</span></span><a class="reference internal" href="_modules/diffusionlab/schedulers.html#UniformScheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.schedulers.UniformScheduler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#diffusionlab.schedulers.Scheduler" title="diffusionlab.schedulers.Scheduler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scheduler</span></code></a></p>
<p>A scheduler that generates uniformly spaced time steps.</p>
<p>Requires <code class="docutils literal notranslate"><span class="pre">t_min</span></code>, <code class="docutils literal notranslate"><span class="pre">t_max</span></code>, and <code class="docutils literal notranslate"><span class="pre">num_steps</span></code> to be passed
to the <code class="docutils literal notranslate"><span class="pre">get_ts</span></code> method via keyword arguments. The number of points generated
will be <code class="docutils literal notranslate"><span class="pre">num_steps</span> <span class="pre">+</span> <span class="pre">1</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="diffusionlab.schedulers.UniformScheduler.get_ts">
<span class="sig-name descname"><span class="pre">get_ts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">ts_hparams</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/schedulers.html#UniformScheduler.get_ts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.schedulers.UniformScheduler.get_ts" title="Link to this definition">¶</a></dt>
<dd><p>Generate uniformly spaced time steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**ts_hparams</strong> (<code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>) – <p>Keyword arguments must contain</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">t_min</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The minimum time value, typically close to 0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t_max</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The maximum time value, typically close to 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_steps</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): The number of diffusion steps. The function will generate <code class="docutils literal notranslate"><span class="pre">num_steps</span> <span class="pre">+</span> <span class="pre">1</span></code> time points.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A JAX array containing uniformly spaced time steps</dt><dd><p>in descending order (from <code class="docutils literal notranslate"><span class="pre">t_max</span></code> to <code class="docutils literal notranslate"><span class="pre">t_min</span></code>).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[num_steps+1]</span></code></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>KeyError</strong> – If <code class="docutils literal notranslate"><span class="pre">t_min</span></code>, <code class="docutils literal notranslate"><span class="pre">t_max</span></code>, or <code class="docutils literal notranslate"><span class="pre">num_steps</span></code> is not found in <code class="docutils literal notranslate"><span class="pre">ts_hparams</span></code>.</p></li>
<li><p><strong>AssertionError</strong> – If <code class="docutils literal notranslate"><span class="pre">t_min</span></code>/<code class="docutils literal notranslate"><span class="pre">t_max</span></code> constraints are violated or <code class="docutils literal notranslate"><span class="pre">num_steps</span></code> &lt; 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-diffusionlab.vector_fields">
<span id="diffusionlab-vector-fields"></span><h2><code class="docutils literal notranslate"><span class="pre">diffusionlab.vector_fields</span></code><a class="headerlink" href="#module-diffusionlab.vector_fields" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="diffusionlab.vector_fields.VectorFieldType">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">diffusionlab.vector_fields.</span></span><span class="sig-name descname"><span class="pre">VectorFieldType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/diffusionlab/vector_fields.html#VectorFieldType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.vector_fields.VectorFieldType" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>Enum representing the type of a vector field.
A vector field is a function that takes in <code class="docutils literal notranslate"><span class="pre">x_t</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) and <code class="docutils literal notranslate"><span class="pre">t</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>)
and returns a vector of the same shape as <code class="docutils literal notranslate"><span class="pre">x_t</span></code> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>).</p>
<p>DiffusionLab supports the following vector field types:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">VectorFieldType.SCORE</span></code>: The score of the distribution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VectorFieldType.X0</span></code>: The denoised state.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VectorFieldType.EPS</span></code>: The noise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VectorFieldType.V</span></code>: The velocity field.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="diffusionlab.vector_fields.convert_vector_field_type">
<span class="sig-prename descclassname"><span class="pre">diffusionlab.vector_fields.</span></span><span class="sig-name descname"><span class="pre">convert_vector_field_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_prime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_prime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.vector_fields.VectorFieldType" title="diffusionlab.vector_fields.VectorFieldType"><span class="pre">VectorFieldType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#diffusionlab.vector_fields.VectorFieldType" title="diffusionlab.vector_fields.VectorFieldType"><span class="pre">VectorFieldType</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Array</span></span></span><a class="reference internal" href="_modules/diffusionlab/vector_fields.html#convert_vector_field_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#diffusionlab.vector_fields.convert_vector_field_type" title="Link to this definition">¶</a></dt>
<dd><p>Converts the output of a vector field from one type to another.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The input tensor.</p></li>
<li><p><strong>f_x</strong> (<code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code>) – The output of the vector field f evaluated at x.</p></li>
<li><p><strong>alpha</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – A scalar representing the scale parameter.</p></li>
<li><p><strong>sigma</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – A scalar representing the noise level parameter.</p></li>
<li><p><strong>alpha_prime</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – A scalar representing the scale derivative parameter.</p></li>
<li><p><strong>sigma_prime</strong> (<code class="docutils literal notranslate"><span class="pre">Array[]</span></code>) – A scalar representing the noise level derivative parameter.</p></li>
<li><p><strong>in_type</strong> (<code class="docutils literal notranslate"><span class="pre">VectorFieldType</span></code>) – The type of the input vector field (e.g. <code class="docutils literal notranslate"><span class="pre">VectorFieldType.SCORE</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.X0</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.EPS</span></code>, <code class="docutils literal notranslate"><span class="pre">VectorFieldType.V</span></code>).</p></li>
<li><p><strong>out_type</strong> (<code class="docutils literal notranslate"><span class="pre">VectorFieldType</span></code>) – The type of the output vector field.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The converted output of the vector field</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Array[*data_dims]</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Druv Pai
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">API Reference</a><ul>
<li><a class="reference internal" href="#module-diffusionlab"><code class="docutils literal notranslate"><span class="pre">diffusionlab</span></code></a></li>
<li><a class="reference internal" href="#module-diffusionlab.distributions"><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions</span></code></a><ul>
<li><a class="reference internal" href="#module-diffusionlab.distributions.base"><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.base</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.distributions.base.Distribution"><code class="docutils literal notranslate"><span class="pre">Distribution</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.distributions.base.Distribution.dist_params"><code class="docutils literal notranslate"><span class="pre">Distribution.dist_params</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.base.Distribution.dist_hparams"><code class="docutils literal notranslate"><span class="pre">Distribution.dist_hparams</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.base.Distribution.eps"><code class="docutils literal notranslate"><span class="pre">Distribution.eps()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.base.Distribution.get_vector_field"><code class="docutils literal notranslate"><span class="pre">Distribution.get_vector_field()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.base.Distribution.sample"><code class="docutils literal notranslate"><span class="pre">Distribution.sample()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.base.Distribution.score"><code class="docutils literal notranslate"><span class="pre">Distribution.score()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.base.Distribution.v"><code class="docutils literal notranslate"><span class="pre">Distribution.v()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.base.Distribution.x0"><code class="docutils literal notranslate"><span class="pre">Distribution.x0()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-diffusionlab.distributions.empirical"><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.empirical</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.distributions.empirical.EmpiricalDistribution"><code class="docutils literal notranslate"><span class="pre">EmpiricalDistribution</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.distributions.empirical.EmpiricalDistribution.dist_params"><code class="docutils literal notranslate"><span class="pre">EmpiricalDistribution.dist_params</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.empirical.EmpiricalDistribution.dist_hparams"><code class="docutils literal notranslate"><span class="pre">EmpiricalDistribution.dist_hparams</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.empirical.EmpiricalDistribution.eps"><code class="docutils literal notranslate"><span class="pre">EmpiricalDistribution.eps()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.empirical.EmpiricalDistribution.sample"><code class="docutils literal notranslate"><span class="pre">EmpiricalDistribution.sample()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.empirical.EmpiricalDistribution.score"><code class="docutils literal notranslate"><span class="pre">EmpiricalDistribution.score()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.empirical.EmpiricalDistribution.v"><code class="docutils literal notranslate"><span class="pre">EmpiricalDistribution.v()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.empirical.EmpiricalDistribution.x0"><code class="docutils literal notranslate"><span class="pre">EmpiricalDistribution.x0()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-diffusionlab.distributions.gmm"><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.gmm</span></code></a><ul>
<li><a class="reference internal" href="#module-diffusionlab.distributions.gmm.gmm"><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.gmm.gmm</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.gmm.GMM"><code class="docutils literal notranslate"><span class="pre">GMM</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.gmm.GMM.dist_params"><code class="docutils literal notranslate"><span class="pre">GMM.dist_params</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.gmm.GMM.dist_hparams"><code class="docutils literal notranslate"><span class="pre">GMM.dist_hparams</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.gmm.GMM.eps"><code class="docutils literal notranslate"><span class="pre">GMM.eps()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.gmm.GMM.sample"><code class="docutils literal notranslate"><span class="pre">GMM.sample()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.gmm.GMM.score"><code class="docutils literal notranslate"><span class="pre">GMM.score()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.gmm.GMM.v"><code class="docutils literal notranslate"><span class="pre">GMM.v()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.gmm.GMM.x0"><code class="docutils literal notranslate"><span class="pre">GMM.x0()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.gmm.gmm_x0"><code class="docutils literal notranslate"><span class="pre">gmm_x0()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-diffusionlab.distributions.gmm.iso_gmm"><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.gmm.iso_gmm</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM"><code class="docutils literal notranslate"><span class="pre">IsoGMM</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM.dist_params"><code class="docutils literal notranslate"><span class="pre">IsoGMM.dist_params</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM.dist_hparams"><code class="docutils literal notranslate"><span class="pre">IsoGMM.dist_hparams</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM.eps"><code class="docutils literal notranslate"><span class="pre">IsoGMM.eps()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM.sample"><code class="docutils literal notranslate"><span class="pre">IsoGMM.sample()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM.score"><code class="docutils literal notranslate"><span class="pre">IsoGMM.score()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM.v"><code class="docutils literal notranslate"><span class="pre">IsoGMM.v()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_gmm.IsoGMM.x0"><code class="docutils literal notranslate"><span class="pre">IsoGMM.x0()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_gmm.iso_gmm_x0"><code class="docutils literal notranslate"><span class="pre">iso_gmm_x0()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-diffusionlab.distributions.gmm.iso_hom_gmm"><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.gmm.iso_hom_gmm</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM"><code class="docutils literal notranslate"><span class="pre">IsoHomGMM</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.dist_params"><code class="docutils literal notranslate"><span class="pre">IsoHomGMM.dist_params</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.dist_hparams"><code class="docutils literal notranslate"><span class="pre">IsoHomGMM.dist_hparams</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.eps"><code class="docutils literal notranslate"><span class="pre">IsoHomGMM.eps()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.sample"><code class="docutils literal notranslate"><span class="pre">IsoHomGMM.sample()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.score"><code class="docutils literal notranslate"><span class="pre">IsoHomGMM.score()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.v"><code class="docutils literal notranslate"><span class="pre">IsoHomGMM.v()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_hom_gmm.IsoHomGMM.x0"><code class="docutils literal notranslate"><span class="pre">IsoHomGMM.x0()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.iso_hom_gmm.iso_hom_gmm_x0"><code class="docutils literal notranslate"><span class="pre">iso_hom_gmm_x0()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-diffusionlab.distributions.gmm.low_rank_gmm"><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.gmm.low_rank_gmm</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM"><code class="docutils literal notranslate"><span class="pre">LowRankGMM</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.dist_params"><code class="docutils literal notranslate"><span class="pre">LowRankGMM.dist_params</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.dist_hparams"><code class="docutils literal notranslate"><span class="pre">LowRankGMM.dist_hparams</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.eps"><code class="docutils literal notranslate"><span class="pre">LowRankGMM.eps()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.sample"><code class="docutils literal notranslate"><span class="pre">LowRankGMM.sample()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.score"><code class="docutils literal notranslate"><span class="pre">LowRankGMM.score()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.v"><code class="docutils literal notranslate"><span class="pre">LowRankGMM.v()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.low_rank_gmm.LowRankGMM.x0"><code class="docutils literal notranslate"><span class="pre">LowRankGMM.x0()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.low_rank_gmm.low_rank_gmm_x0"><code class="docutils literal notranslate"><span class="pre">low_rank_gmm_x0()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-diffusionlab.distributions.gmm.utils"><code class="docutils literal notranslate"><span class="pre">diffusionlab.distributions.gmm.utils</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.distributions.gmm.utils.create_gmm_vector_field_fns"><code class="docutils literal notranslate"><span class="pre">create_gmm_vector_field_fns()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-diffusionlab.dynamics"><code class="docutils literal notranslate"><span class="pre">diffusionlab.dynamics</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess"><code class="docutils literal notranslate"><span class="pre">DiffusionProcess</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess.alpha"><code class="docutils literal notranslate"><span class="pre">DiffusionProcess.alpha</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess.sigma"><code class="docutils literal notranslate"><span class="pre">DiffusionProcess.sigma</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess.alpha_prime"><code class="docutils literal notranslate"><span class="pre">DiffusionProcess.alpha_prime</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess.sigma_prime"><code class="docutils literal notranslate"><span class="pre">DiffusionProcess.sigma_prime</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.dynamics.DiffusionProcess.forward"><code class="docutils literal notranslate"><span class="pre">DiffusionProcess.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#diffusionlab.dynamics.FlowMatchingProcess"><code class="docutils literal notranslate"><span class="pre">FlowMatchingProcess</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.dynamics.FlowMatchingProcess.alpha"><code class="docutils literal notranslate"><span class="pre">FlowMatchingProcess.alpha</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.dynamics.FlowMatchingProcess.sigma"><code class="docutils literal notranslate"><span class="pre">FlowMatchingProcess.sigma</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.dynamics.FlowMatchingProcess.alpha_prime"><code class="docutils literal notranslate"><span class="pre">FlowMatchingProcess.alpha_prime</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.dynamics.FlowMatchingProcess.sigma_prime"><code class="docutils literal notranslate"><span class="pre">FlowMatchingProcess.sigma_prime</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#diffusionlab.dynamics.VarianceExplodingProcess"><code class="docutils literal notranslate"><span class="pre">VarianceExplodingProcess</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.dynamics.VarianceExplodingProcess.alpha"><code class="docutils literal notranslate"><span class="pre">VarianceExplodingProcess.alpha</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.dynamics.VarianceExplodingProcess.sigma"><code class="docutils literal notranslate"><span class="pre">VarianceExplodingProcess.sigma</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.dynamics.VarianceExplodingProcess.alpha_prime"><code class="docutils literal notranslate"><span class="pre">VarianceExplodingProcess.alpha_prime</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.dynamics.VarianceExplodingProcess.sigma_prime"><code class="docutils literal notranslate"><span class="pre">VarianceExplodingProcess.sigma_prime</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#diffusionlab.dynamics.VariancePreservingProcess"><code class="docutils literal notranslate"><span class="pre">VariancePreservingProcess</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.dynamics.VariancePreservingProcess.alpha"><code class="docutils literal notranslate"><span class="pre">VariancePreservingProcess.alpha</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.dynamics.VariancePreservingProcess.sigma"><code class="docutils literal notranslate"><span class="pre">VariancePreservingProcess.sigma</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.dynamics.VariancePreservingProcess.alpha_prime"><code class="docutils literal notranslate"><span class="pre">VariancePreservingProcess.alpha_prime</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.dynamics.VariancePreservingProcess.sigma_prime"><code class="docutils literal notranslate"><span class="pre">VariancePreservingProcess.sigma_prime</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-diffusionlab.losses"><code class="docutils literal notranslate"><span class="pre">diffusionlab.losses</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.losses.DiffusionLoss"><code class="docutils literal notranslate"><span class="pre">DiffusionLoss</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.losses.DiffusionLoss.diffusion_process"><code class="docutils literal notranslate"><span class="pre">DiffusionLoss.diffusion_process</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.losses.DiffusionLoss.vector_field_type"><code class="docutils literal notranslate"><span class="pre">DiffusionLoss.vector_field_type</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.losses.DiffusionLoss.num_noise_draws_per_sample"><code class="docutils literal notranslate"><span class="pre">DiffusionLoss.num_noise_draws_per_sample</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.losses.DiffusionLoss.target"><code class="docutils literal notranslate"><span class="pre">DiffusionLoss.target</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.losses.DiffusionLoss.loss"><code class="docutils literal notranslate"><span class="pre">DiffusionLoss.loss()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.losses.DiffusionLoss.prediction_loss"><code class="docutils literal notranslate"><span class="pre">DiffusionLoss.prediction_loss()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-diffusionlab.samplers"><code class="docutils literal notranslate"><span class="pre">diffusionlab.samplers</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.samplers.DDMSampler"><code class="docutils literal notranslate"><span class="pre">DDMSampler</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.samplers.DDMSampler.diffusion_process"><code class="docutils literal notranslate"><span class="pre">DDMSampler.diffusion_process</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.DDMSampler.vector_field"><code class="docutils literal notranslate"><span class="pre">DDMSampler.vector_field</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.DDMSampler.vector_field_type"><code class="docutils literal notranslate"><span class="pre">DDMSampler.vector_field_type</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.DDMSampler.use_stochastic_sampler"><code class="docutils literal notranslate"><span class="pre">DDMSampler.use_stochastic_sampler</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.DDMSampler.sample_step"><code class="docutils literal notranslate"><span class="pre">DDMSampler.sample_step</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.DDMSampler.get_sample_step_function"><code class="docutils literal notranslate"><span class="pre">DDMSampler.get_sample_step_function()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#diffusionlab.samplers.EulerMaruyamaSampler"><code class="docutils literal notranslate"><span class="pre">EulerMaruyamaSampler</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.samplers.EulerMaruyamaSampler.diffusion_process"><code class="docutils literal notranslate"><span class="pre">EulerMaruyamaSampler.diffusion_process</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.EulerMaruyamaSampler.vector_field"><code class="docutils literal notranslate"><span class="pre">EulerMaruyamaSampler.vector_field</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.EulerMaruyamaSampler.vector_field_type"><code class="docutils literal notranslate"><span class="pre">EulerMaruyamaSampler.vector_field_type</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.EulerMaruyamaSampler.use_stochastic_sampler"><code class="docutils literal notranslate"><span class="pre">EulerMaruyamaSampler.use_stochastic_sampler</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.EulerMaruyamaSampler.sample_step"><code class="docutils literal notranslate"><span class="pre">EulerMaruyamaSampler.sample_step</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.EulerMaruyamaSampler.get_sample_step_function"><code class="docutils literal notranslate"><span class="pre">EulerMaruyamaSampler.get_sample_step_function()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#diffusionlab.samplers.Sampler"><code class="docutils literal notranslate"><span class="pre">Sampler</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.samplers.Sampler.diffusion_process"><code class="docutils literal notranslate"><span class="pre">Sampler.diffusion_process</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.Sampler.vector_field"><code class="docutils literal notranslate"><span class="pre">Sampler.vector_field</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.Sampler.vector_field_type"><code class="docutils literal notranslate"><span class="pre">Sampler.vector_field_type</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.Sampler.use_stochastic_sampler"><code class="docutils literal notranslate"><span class="pre">Sampler.use_stochastic_sampler</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.Sampler.sample_step"><code class="docutils literal notranslate"><span class="pre">Sampler.sample_step</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.Sampler.get_sample_step_function"><code class="docutils literal notranslate"><span class="pre">Sampler.get_sample_step_function()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.Sampler.sample"><code class="docutils literal notranslate"><span class="pre">Sampler.sample()</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.samplers.Sampler.sample_trajectory"><code class="docutils literal notranslate"><span class="pre">Sampler.sample_trajectory()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-diffusionlab.schedulers"><code class="docutils literal notranslate"><span class="pre">diffusionlab.schedulers</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.schedulers.Scheduler"><code class="docutils literal notranslate"><span class="pre">Scheduler</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.schedulers.Scheduler.get_ts"><code class="docutils literal notranslate"><span class="pre">Scheduler.get_ts()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#diffusionlab.schedulers.UniformScheduler"><code class="docutils literal notranslate"><span class="pre">UniformScheduler</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.schedulers.UniformScheduler.get_ts"><code class="docutils literal notranslate"><span class="pre">UniformScheduler.get_ts()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-diffusionlab.vector_fields"><code class="docutils literal notranslate"><span class="pre">diffusionlab.vector_fields</span></code></a><ul>
<li><a class="reference internal" href="#diffusionlab.vector_fields.VectorFieldType"><code class="docutils literal notranslate"><span class="pre">VectorFieldType</span></code></a></li>
<li><a class="reference internal" href="#diffusionlab.vector_fields.convert_vector_field_type"><code class="docutils literal notranslate"><span class="pre">convert_vector_field_type()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>